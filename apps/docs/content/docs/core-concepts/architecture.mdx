---
title: Architecture
description: How Agentic Zero is structured â€” the Bridge Pattern
---

# Architecture

Agentic Zero is built on a layered **Bridge Pattern** that cleanly separates intent from execution.

## The Three Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            ğŸ§  The Brain (XState)        â”‚
â”‚         Decides intent & state          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        ğŸ¯ The Orchestrator              â”‚
â”‚    Translates intent into actions       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           ğŸŒ‰ The Bridge                 â”‚
â”‚  Executes actions & verifies results    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1. The Brain (XState State Machine)

The brain is a **deterministic state machine** built with [XState](https://xstate.js.org/). It manages the agent's lifecycle through well-defined states:

- **Idle** â€” Waiting for activation
- **Scanning** â€” Analyzing DOM checkpoints
- **Navigating** â€” Scrolling/transitioning to a checkpoint
- **Narrating** â€” Streaming LLM-generated narration
- **Paused** â€” Interrupted by user interaction
- **Complete** â€” Tour finished

The brain never touches the DOM directly â€” it only emits *intents*.

### 2. The Orchestrator (BridgeOrchestrator)

The `BridgeOrchestrator` receives intents from the brain and coordinates the appropriate bridge modules:

- Routes navigation intents to the **ShadowPiercer** for DOM traversal
- Activates the **NarrativeEngine** for streaming narration
- Delegates to the **SelfCorrector** to verify actions succeeded
- Manages the **InterruptionManager** when users take control

### 3. The Bridge Modules

Each bridge module has a single responsibility:

| Module | Responsibility |
|:--|:--|
| `ShadowPiercer` | Recursive DOM traversal through Shadow DOM and iframes |
| `NarrativeEngine` | Streaming AI commentary via Vercel AI SDK |
| `SelfCorrector` | Retry logic for missed scrolls or clicks |
| `InterruptionManager` | Tug-of-war detection between agent and user |
| `PIISanitizer` | Redaction of sensitive data before LLM |
| `FlightRecorder` | Session telemetry and debugging |
| `ContextObserver` | DOM mutation and viewport observation |

## Data Flow

```
User clicks "Start Tour"
  â†’ Brain transitions: idle â†’ scanning
    â†’ Orchestrator discovers checkpoints
      â†’ Brain transitions: scanning â†’ navigating
        â†’ ShadowPiercer scrolls to element
          â†’ SelfCorrector verifies visibility
            â†’ Brain transitions: navigating â†’ narrating
              â†’ NarrativeEngine streams commentary
                â†’ Brain transitions: narrating â†’ navigating (next checkpoint)
```

## Design Principles

1. **Determinism** â€” The state machine ensures predictable behavior. Every possible state transition is explicit.
2. **Separation of Concerns** â€” The brain doesn't know about the DOM. The bridge doesn't know about state.
3. **Resilience** â€” Self-correction and interruption handling make the system robust in the real world.
4. **Privacy** â€” PII sanitization ensures sensitive data never reaches the LLM.
5. **Observability** â€” The Flight Recorder captures everything for debugging.
